{% extends 'sportif/base.html.twig' %}

{% block title %}Mes R√©clamations{% endblock %}

{% block stylesheets %}
    <style>
        :root {
            --primary-orange: #F28C38;
            --dark-black: #000000;
            --white: #ffffff;
            --light-gray: #f8f9fa;
            --border-gray: #dee2e6;
            --gradient-orange: linear-gradient(45deg, #F28C38, #e07b30);
        }

        body {
            background-color: var(--dark-black);
            color: var(--white);
            font-family: 'Roboto', 'Arial', sans-serif;
        }

        .container {
            max-width: 900px;
            margin: 3rem auto;
            padding: 2rem;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }

        h1 {
            color: var(--primary-orange);
            font-weight: 700;
            text-align: center;
            margin-bottom: 2.5rem;
            font-size: 2.2rem;
        }

        h2 {
            color: var(--dark-black);
            font-size: 1.6rem;
            margin-top: 2.5rem;
            margin-bottom: 1.5rem;
        }

        .input-group .form-select {
            border-color: var(--primary-orange);
            color: var(--dark-black);
            font-weight: 500;
            background-color: var(--white);
            border-radius: 8px;
        }

        .input-group .form-select:focus {
            border-color: var(--primary-orange);
            box-shadow: 0 0 8px rgba(242, 140, 56, 0.4);
        }

        .list-group-item {
            border: 1px solid var(--border-gray);
            border-radius: 10px;
            margin-bottom: 1.2rem;
            padding: 1.8rem;
            background-color: var(--white);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .list-group-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .list-group-item strong {
            color: var(--primary-orange);
            font-size: 1.3rem;
            font-weight: 600;
        }

        .list-group-item p {
            color: var(--dark-black);
            font-size: 1rem;
        }

        .alert-info {
            background: var(--gradient-orange);
            color: var(--white);
            border: none;
            border-radius: 8px;
            padding: 1rem;
            font-size: 0.95rem;
            margin-top: 0.8rem;
        }

        .alert-warning {
            background-color: #fff3cd;
            color: var(--dark-black);
            border: 1px solid #ffecb5;
            border-radius: 8px;
            padding: 1rem;
            font-size: 0.95rem;
            margin-top: 0.8rem;
        }

        .btn-danger {
            background-color: var(--dark-black);
            border-color: var(--dark-black);
            font-weight: 500;
            border-radius: 8px;
            transition: background-color 0.3s, transform 0.2s;
        }

        .btn-danger:hover {
            background-color: #333;
            border-color: #333;
            transform: scale(1.05);
        }

        .form-control, .form-select {
            border-radius: 8px;
            border: 1px solid var(--border-gray);
            font-size: 1rem;
            padding: 0.75rem;
        }

        .form-control:focus {
            border-color: var(--primary-orange);
            box-shadow: 0 0 8px rgba(242, 140, 56, 0.4);
        }

        .btn-primary {
            background: var(--gradient-orange);
            border: none;
            font-weight: 600;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .btn-primary:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(242, 140, 56, 0.4);
        }

        .form-label {
            color: var(--dark-black);
            font-weight: 500;
        }

        .invalid-feedback {
            color: #dc3545;
            font-size: 0.85rem;
        }

        /* Header-specific styles */
        .header-section .nav-menu ul li a {
            color: var(--white);
            font-weight: 500;
            padding: 10px 15px;
            transition: color 0.3s;
        }

        .header-section .nav-menu ul li.active a,
        .header-section .nav-menu ul li a:hover {
            color: var(--primary-orange);
        }

        .header-section .dropdown {
            background-color: #1a1a1a;
            border: none;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .header-section .dropdown li a {
            color: var(--white);
            padding: 8px 15px;
        }

        .header-section .dropdown li a:hover {
            background-color: var(--primary-orange);
            color: var(--white);
        }

        .offcanvas-menu-wrapper {
            background-color: #1a1a1a;
        }

        .offcanvas-menu-wrapper .canvas-menu ul li a {
            color: var(--white);
            font-weight: 500;
            padding: 10px 15px;
        }

        .offcanvas-menu-wrapper .canvas-menu ul li a:hover {
            color: var(--primary-orange);
        }

        .offcanvas-menu-wrapper .dropdown {
            background-color: #2c2c2c;
        }

        .offcanvas-menu-wrapper .dropdown li a {
            color: var(--white);
        }

        .offcanvas-menu-wrapper .dropdown li a:hover {
            background-color: var(--primary-orange);
            color: var(--white);
        }

        .canvas-social a,
        .to-social a {
            color: var(--white);
            margin: 0 8px;
            transition: color 0.3s;
        }

        .canvas-social a:hover,
        .to-social a:hover {
            color: var(--primary-orange);
        }

        .canvas-open i,
        .canvas-close i,
        .search-switch i {
            color: var(--white);
            font-size: 1.2rem;
            transition: color 0.3s;
        }

        .canvas-open i:hover,
        .canvas-close i:hover,
        .search-switch i:hover {
            color: var(--primary-orange);
        }

        @media (max-width: 576px) {
            .container {
                padding: 1.2rem;
                margin: 1rem;
            }

            h1 {
                font-size: 1.8rem;
            }

            .list-group-item {
                padding: 1.2rem;
            }

            .btn-primary, .btn-danger {
                padding: 0.6rem 1rem;
            }
        }
    </style>
{% endblock %}

{% block body %}
<div class="container">
    <h1>üìå Mes R√©clamations</h1>

    <!-- Filtre -->
    <form method="get" class="mb-4">
        <div class="input-group">
            <select name="filter" class="form-select" onchange="this.form.submit()">
                <option value="Tous" {% if filter == 'Tous' %}selected{% endif %}>Tous</option>
                <option value="En attente" {% if filter == 'En attente' %}selected{% endif %}>‚è≥ En attente</option>
                <option value="Trait√©e" {% if filter == 'Trait√©e' %}selected{% endif %}>‚úÖ Trait√©</option>
            </select>
        </div>
    </form>

    <!-- Liste des r√©clamations -->
    <ul class="list-group mb-4">
        {% for reclamation in reclamations %}
        <li class="list-group-item">
            <strong>{{ reclamation.sujet }}</strong> | {{ reclamation.statut }}<br>
            <p class="mb-2">{{ reclamation.description }}</p>
            {% if reclamation.reponses|length > 0 %}
                {% for reponse in reclamation.reponses %}
                    <div class="alert alert-info mt-2">
                        üó® R√©ponse ({{ reponse.dateReponse|date('d/m/Y H:i') }}): {{ reponse.message }}
                    </div>
                {% endfor %}
            {% else %}
                <div class="alert alert-warning mt-2">‚è≥ En attente de r√©ponse</div>
            {% endif %}
            <form action="{{ path('app_reclamation_delete', {'id': reclamation.id}) }}" method="post" style="display:inline;" onsubmit="return confirm('Voulez-vous vraiment supprimer cette r√©clamation ?');">
                <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ reclamation.id) }}">
                <button type="submit" class="btn btn-danger btn-sm">üóë Supprimer</button>
            </form>
        </li>
        {% else %}
        <li class="list-group-item">Aucune r√©clamation trouv√©e.</li>
        {% endfor %}
    </ul>

    <!-- Formulaire d'ajout -->
    <h2>Ajouter une r√©clamation</h2>
    {{ form_start(form, {'attr': {'class': 'needs-validation', 'novalidate': 'novalidate'}}) }}
        <div class="mb-3">
            {{ form_label(form.sujet, 'Sujet', {'label_attr': {'class': 'form-label'}}) }}
            {{ form_widget(form.sujet, {'attr': {'class': 'form-control', 'required': 'required'}}) }}
            {{ form_errors(form.sujet, {'attr': {'class': 'invalid-feedback'}}) }}
        </div>
        <div class="mb-3">
            {{ form_label(form.description, 'Description', {'label_attr': {'class': 'form-label'}}) }}
            {{ form_widget(form.description, {'attr': {'class': 'form-control', 'required': 'required'}}) }}
            {{ form_errors(form.description, {'attr': {'class': 'invalid-feedback'}}) }}
        </div>
        {{ form_widget(form.submit, {'attr': {'class': 'btn btn-primary'}}) }}
    {{ form_end(form) }}
</div>
{% endblock %}
