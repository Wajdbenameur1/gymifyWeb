{% extends 'base.html.twig' %}

{% block title %}Mes Réclamations{% endblock %}

{% block body %}
<div class="min-h-screen bg-gradient-to-r from-blue-100 to-blue-200 p-6 flex">
    <!-- Sidebar -->
    <div class="w-12 bg-orange-500"></div>
    <!-- Main Content -->
    <div class="flex-1 max-w-2xl mx-auto bg-white p-8 rounded-lg shadow-lg">
        <h1 class="text-3xl font-bold mb-6 text-orange-500">📌 Mes Réclamations</h1>
        <!-- Filter -->
        <div class="mb-4">
            <form method="get">
                <select name="status" onchange="this.form.submit()" class="p-2 border rounded-lg">
                    <option value="Tous" {{ selected_status == 'Tous' ? 'selected' : '' }}>Tous</option>
                    <option value="En attente" {{ selected_status == 'En attente' ? 'selected' : '' }}>⏳ En attente</option>
                    <option value="Traitée" {{ selected_status == 'Traitée' ? 'selected' : '' }}>✅ Traité</option>
                </select>
            </form>
        </div>
        <!-- Reclamations List -->
        <div class="max-h-40 overflow-y-auto mb-4">
            {% for reclamation in reclamations %}
                <div class="p-2 bg-gray-100 rounded-lg mb-2 cursor-pointer" onclick="showResponse('{{ reclamation.id }}')">
                    📝 {{ reclamation.sujet }} | 📌 {{ reclamation.statut }}
                </div>
            {% endfor %}
        </div>
        <!-- Response Display -->
        <div id="response-display" class="p-2 border rounded-lg mb-4"></div>
        <!-- New Reclamation Form -->
        {{ form_start(form) }}
            {{ form_widget(form.sujet) }}
            {{ form_widget(form.description) }}
            <div class="flex gap-4">
                <button type="submit" class="bg-green-500 text-white px-4 py-2 rounded-lg">📤 Envoyer</button>
                <a href="{{ path('sportif_reclamations_index') }}" class="bg-blue-500 text-white px-4 py-2 rounded-lg">❌ Annuler</a>
            </div>
        {{ form_end(form) }}
    </div>
    <!-- Sidebar -->
    <div class="w-12 bg-orange-500"></div>
</div>
<script>
    async function showResponse(id) {
        const response = await fetch(`/sportif/reclamations/response/${id}`);
        const data = await response.json();
        document.getElementById('response-display').innerText = data.message;
    }
</script>
{% endblock %}